{"id":"9ae6082b-c7f4-433c-9971-7a8f65a3ea65","revision":0,"last_node_id":168,"last_link_id":277,"nodes":[{"id":63,"type":"VAELoader","pos":[970,450],"size":[270,58],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"vae_name","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","links":[73,190]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.73","Node name for S&R":"VAELoader","models":[{"name":"ae.safetensors","url":"https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/vae/ae.safetensors","directory":"vae"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":["ae.safetensors"]},{"id":68,"type":"EmptySD3LatentImage","pos":[980,610],"size":[260,106],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"batch_size","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[77,187]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"EmptySD3LatentImage","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[1024,1024,1]},{"id":62,"type":"CLIPLoader","pos":[970,300],"size":[270,106],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"clip_name","name":"clip_name","type":"COMBO","widget":{"name":"clip_name"},"link":null},{"localized_name":"type","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"device","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[78,82]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.73","Node name for S&R":"CLIPLoader","models":[{"name":"qwen_3_4b.safetensors","url":"https://huggingface.co/Comfy-Org/z_image_turbo/resolve/main/split_files/text_encoders/qwen_3_4b.safetensors","directory":"text_encoders"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":["qwen_3_4b.safetensors","lumina2","default"]},{"id":71,"type":"CLIPTextEncode","pos":[1290,540],"size":[390,125],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":82},{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","links":[83,186]}],"title":"CLIP Text Encode (Negative Prompt)","properties":{"cnr_id":"comfy-core","ver":"0.3.73","Node name for S&R":"CLIPTextEncode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[""],"color":"#323","bgcolor":"#535"},{"id":35,"type":"MarkdownNote","pos":[410,130],"size":[520,560],"flags":{"collapsed":false},"order":3,"mode":0,"inputs":[],"outputs":[],"title":"Models","properties":{},"widgets_values":["## You can use Z-Image base (recently released) or Z-Image Turbo for inference.\n\n## I have the workflow set up for Z-Image Turbo (sue me I hate waiting and it's good enough for me)\n"],"color":"#432","bgcolor":"#000"},{"id":123,"type":"PreviewImage","pos":[2080,230],"size":[550,520],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":234}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.11.0","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":70,"type":"ModelSamplingAuraFlow","pos":[1740,130],"size":[310,58],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":219},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","slot_index":0,"links":[179,260]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"ModelSamplingAuraFlow","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[3]},{"id":65,"type":"VAEDecode","pos":[2080,130],"size":[210,46],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"samples","name":"samples","type":"LATENT","link":72},{"localized_name":"vae","name":"vae","type":"VAE","link":73}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[234]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"VAEDecode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[]},{"id":115,"type":"VAEDecode","pos":[2930,140],"size":[210,46],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"samples","name":"samples","type":"LATENT","link":184},{"localized_name":"vae","name":"vae","type":"VAE","link":190}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[231]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"VAEDecode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[]},{"id":66,"type":"UNETLoader","pos":[970,170],"size":[270,82],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"unet_name","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null},{"localized_name":"weight_dtype","name":"weight_dtype","type":"COMBO","widget":{"name":"weight_dtype"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[219]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.73","Node name for S&R":"UNETLoader","models":[{"name":"z_image_bf16.safetensors","url":"https://huggingface.co/Comfy-Org/z_image/resolve/main/split_files/diffusion_models/z_image_bf16.safetensors","directory":"diffusion_models"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":["ZImageTurbo/z_image_turbo_bf16.safetensors","default"]},{"id":136,"type":"PreviewImage","pos":[3060,240],"size":[550,520],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":231}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.11.0","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":69,"type":"KSampler","pos":[1740,240],"size":[310,435],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":180},{"localized_name":"positive","name":"positive","type":"CONDITIONING","link":75},{"localized_name":"negative","name":"negative","type":"CONDITIONING","link":83},{"localized_name":"latent_image","name":"latent_image","type":"LATENT","link":77},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"sampler_name","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"denoise","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[72]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"KSampler","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[3480527903907,"fixed",9,1,"er_sde","beta57",1]},{"id":114,"type":"KSampler","pos":[2670,260],"size":[310,435],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":260},{"localized_name":"positive","name":"positive","type":"CONDITIONING","link":185},{"localized_name":"negative","name":"negative","type":"CONDITIONING","link":186},{"localized_name":"latent_image","name":"latent_image","type":"LATENT","link":187},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"sampler_name","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"denoise","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[184]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"KSampler","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":[3480527903907,"fixed",9,1,"er_sde","beta57",1]},{"id":76,"type":"LoraLoaderModelOnly","pos":[2030,-360],"size":[270,82],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":179},{"localized_name":"lora_name","name":"lora_name","type":"COMBO","widget":{"name":"lora_name"},"link":233},{"localized_name":"strength_model","name":"strength_model","type":"FLOAT","widget":{"name":"strength_model"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[180]}],"properties":{"cnr_id":"comfy-core","ver":"0.11.0","Node name for S&R":"LoraLoaderModelOnly"},"widgets_values":["ZImage/DiffSynth-Z-Image-i2L.safetensors",1.5]},{"id":125,"type":"MarkdownNote","pos":[640,-410],"size":[500,250],"flags":{"collapsed":false},"order":5,"mode":0,"inputs":[],"outputs":[],"title":"Image Selector to load your folder of images into a batch","properties":{},"widgets_values":["### Load the i2L images (any way to load a batch and scale the batch to 1024x1024 is fine)\n\n### This node automatically resizes to 1024x1024 and pads so we don't lose detail\n\n### It also auto masks the padding so we can inpaint it using flux 2 klein 9B or similar if you like (see my other workflow with a ton of custom node requirements)\n\nNOTE: The folder_path is the absolute path to the folder containing the images e.g.\nC:\\Users\\User\\Documents\\MyDataset\nor on linux\n/home/user/my_datasets\n\nWherever you want the images to load from."],"color":"#432","bgcolor":"#000"},{"id":141,"type":"PreviewAny","pos":[1690,-650],"size":[210,166],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"source","name":"source","type":"*","link":243}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.11.0","Node name for S&R":"PreviewAny"},"widgets_values":[null,null,false]},{"id":121,"type":"ZImageImagesToLoRAAE","pos":[1670,-340],"size":[296.3921875,226],"flags":{"collapsed":false},"order":14,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"*","link":232},{"localized_name":"lora_name","name":"lora_name","type":"STRING","widget":{"name":"lora_name"},"link":null},{"localized_name":"batch_size","name":"batch_size","shape":7,"type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"seed","name":"seed","shape":7,"type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"unload_models_before_running","name":"unload_models_before_running","shape":7,"type":"BOOLEAN","widget":{"name":"unload_models_before_running"},"link":null},{"localized_name":"lora_weights","name":"lora_weights","shape":7,"type":"STRING","widget":{"name":"lora_weights"},"link":277},{"localized_name":"normalize_saved_lora_strength_to","name":"normalize_saved_lora_strength_to","shape":7,"type":"FLOAT","widget":{"name":"normalize_saved_lora_strength_to"},"link":null},{"localized_name":"reduce_size_factor","name":"reduce_size_factor","shape":7,"type":"INT","widget":{"name":"reduce_size_factor"},"link":null}],"outputs":[{"localized_name":"lora_path","name":"lora_path","type":"*","links":[233]}],"properties":{"aux_id":"by-ae/ae-in-workflow","ver":"1693e7fb739a69c5bc3c8e8f526cd2b440e694ac","Node name for S&R":"ZImageImagesToLoRAAE"},"widgets_values":["my_lora",8,0,"fixed",true,"",1,1],"color":"#223","bgcolor":"#335"},{"id":139,"type":"InterpolateFloatListAE","pos":[1260,-280],"size":[370,156],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"floats","name":"floats","type":"STRING","widget":{"name":"floats"},"link":null},{"localized_name":"count","name":"count","shape":7,"type":"INT","widget":{"name":"count"},"link":235},{"localized_name":"interpolate_across_count","name":"interpolate_across_count","shape":7,"type":"BOOLEAN","widget":{"name":"interpolate_across_count"},"link":null}],"outputs":[{"localized_name":"float_list","name":"float_list","type":"*","links":[243]},{"localized_name":"csv_string","name":"csv_string","type":"STRING","links":[277]}],"properties":{"aux_id":"by-ae/ae-in-workflow","ver":"8063e2ef6b97406ddf3c5d299b1303b97a048566","Node name for S&R":"InterpolateFloatListAE"},"widgets_values":["3,2,1,.5",0,true],"color":"#223","bgcolor":"#335"},{"id":138,"type":"Note","pos":[2060,-240],"size":[220,110],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Tweak this to find what your i2L LoRA likes over a variety of prompts. Then you remake it with the same settings but set\n<- reduce_size_factor, so it becomes the new 1.0 default"],"color":"#322","bgcolor":"#533"},{"id":67,"type":"CLIPTextEncode","pos":[1290,170],"size":[410,315],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":78},{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","links":[75,185]}],"title":"CLIP Text Encode (Positive Prompt)","properties":{"cnr_id":"comfy-core","ver":"0.3.73","Node name for S&R":"CLIPTextEncode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65},"widgets_values":["a cat on the road"],"color":"#232","bgcolor":"#353"},{"id":122,"type":"ImageSelectorAE","pos":[640,-650],"size":[500,194],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"folder_path","name":"folder_path","type":"STRING","widget":{"name":"folder_path"},"link":null},{"localized_name":"target_width","name":"target_width","shape":7,"type":"INT","widget":{"name":"target_width"},"link":null},{"localized_name":"target_height","name":"target_height","shape":7,"type":"INT","widget":{"name":"target_height"},"link":null},{"localized_name":"seed","name":"seed","shape":7,"type":"INT","widget":{"name":"seed"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","links":[232]},{"localized_name":"masks","name":"masks","type":"*","links":[]},{"localized_name":"batch_count","name":"batch_count","type":"INT","links":[235]}],"properties":{"aux_id":"by-ae/ae-in-workflow","ver":"1693e7fb739a69c5bc3c8e8f526cd2b440e694ac","Node name for S&R":"ImageSelectorAE"},"widgets_values":["C:\\full\\path\\to\\your\\folder\\of\\images",1024,1024,0,"fixed"],"color":"#223","bgcolor":"#335"}],"links":[[72,69,0,65,0,"LATENT"],[73,63,0,65,1,"VAE"],[75,67,0,69,1,"CONDITIONING"],[77,68,0,69,3,"LATENT"],[78,62,0,67,0,"CLIP"],[82,62,0,71,0,"CLIP"],[83,71,0,69,2,"CONDITIONING"],[179,70,0,76,0,"MODEL"],[180,76,0,69,0,"MODEL"],[184,114,0,115,0,"LATENT"],[185,67,0,114,1,"CONDITIONING"],[186,71,0,114,2,"CONDITIONING"],[187,68,0,114,3,"LATENT"],[190,63,0,115,1,"VAE"],[219,66,0,70,0,"MODEL"],[231,115,0,136,0,"IMAGE"],[232,122,0,121,0,"IMAGE"],[233,121,0,76,1,"COMBO"],[234,65,0,123,0,"IMAGE"],[235,122,2,139,1,"INT"],[243,139,0,141,0,"*"],[260,70,0,114,0,"MODEL"],[277,139,1,121,5,"STRING"]],"groups":[{"id":9,"title":"Inference & Comparison","bounding":[400,-70,3370,1050],"font_size":24,"flags":{}},{"id":2,"title":"Step2 - Image size","bounding":[960,530,290,200],"color":"#3f789e","font_size":24,"flags":{}},{"id":3,"title":"Step3 - Prompt","bounding":[1270,100,440,630],"color":"#3f789e","font_size":24,"flags":{}},{"id":4,"title":"Step1 - Load models","bounding":[960,100,290,413.6],"color":"#3f789e","font_size":24,"flags":{}},{"id":10,"title":"Create the LoRA from the images and load it on the fly (saves into models/loras/Z-Image)","bounding":[1210,-450,1110,350],"color":"#3f789e","font_size":24,"flags":{}},{"id":13,"title":"Preview WITHOUT your lora for comparison (disable these nodes if you don't want)","bounding":[2660,70,1090,883.6],"color":"#3f789e","font_size":24,"flags":{}},{"id":14,"title":"Load the dataset images into a batch","bounding":[620,-740,530,590],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"frontendVersion":"1.37.11","workflowRendererVersion":"LG","VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true,"ds":{"scale":1.6105100000000008,"offset":[-303.6442309193408,867.9850687627321]}},"version":0.4}